<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en" th:fragment="layout(content)" role="document">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content="Funky Hostel Hub ‚Äì browse, view and manage hostels easily."/>
    <meta name="theme-color" content="#7d6df0"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="default"/>
    <meta property="og:title" content="Funky Hostel Hub"/>
    <meta property="og:description" content="Browse hostels, check availability, and manage listings."/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="/"/>
    <meta property="og:image" content="/icons/social-share.png"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="Funky Hostel Hub"/>
    <meta name="twitter:description" content="Browse hostels, check availability, and manage listings."/>
    <meta name="twitter:image" content="/icons/social-share.png"/>
    <title>Funky Hostel Hub</title>
    <link rel="stylesheet" th:href="@{/css/style.css}"/>
    <!-- Primary favicon (dynamic) -->
    <link id="favicon" rel="icon" type="image/svg+xml" href="/images/hostel.svg"/>
    <!-- Shortcut icon for wider compatibility -->
    <link id="faviconShortcut" rel="shortcut icon" type="image/svg+xml" href="/images/hostel.svg"/>
    <!-- Static fallbacks based on OS theme (browser may choose these if JS is blocked or during load) -->
    <link rel="icon" href="/images/hostel.svg" media="(prefers-color-scheme: light)" type="image/svg+xml" sizes="any"/>
    <link rel="icon" href="/images/hostel-dark.svg" media="(prefers-color-scheme: dark)" type="image/svg+xml"
          sizes="any"/>
    <!-- Safari pinned tab (monochrome); color will be updated via JS -->
    <link id="maskIcon" rel="mask-icon" href="/images/hostel.svg" color="#7d6df0"/>
    <!-- Load theme/favicon script only if requested (default true) -->
    <script th:if="${includeThemeScript} ?: true" defer th:src="@{/js/site-theme.js}"></script>
</head>
<body>
<div class="header" role="banner">
    <div class="container header-bar">
        <h1>Funky Hostel Hub</h1>
        <nav class="header-nav" role="navigation" aria-label="Primary">
            <a class="btn" th:href="@{/api/v1}">Home</a>
            <a class="btn" th:href="@{/api/v1/hostels}">Hostels</a>
            <a class="btn" th:href="@{/api/v1/rooms}">Rooms</a>
            <a class="btn" th:href="@{/api/v1/reviews}">Reviews</a>
            <!-- Guest portal links -->
            <a class="btn" th:if="${guestSession} == null or ${guestSession.email} == null"
               th:href="@{/api/v1/guest/login}">Guest Login</a>
            <span th:if="${guestSession} != null and ${guestSession.email} != null">
                <a class="btn" th:href="@{/api/v1/guest/my-rooms}">My Rooms</a>
                <a class="btn" th:href="@{/api/v1/guest/my-reviews}">My Reviews</a>
                <a class="btn" th:href="@{/api/v1/guest/logout}">Logout</a>
            </span>
        </nav>
        <div class="header-actions">
            <!-- Conditional logged-in indicator: prefer name else email -->
            <span th:if="${guestSession} != null and ${guestSession.email} != null"
                  th:with="guestDisplayName=${(guestSession.name != null and !#strings.isEmpty(guestSession.name)) ? guestSession.name : guestSession.email}">
                Logged in as <strong th:text="${guestDisplayName}"></strong>
            </span>
        </div>
    </div>
</div>

<div class="container" role="main">
    <th:block th:insert="${content}"/>
</div>

<div class="footer" role="contentinfo">
    <div class="container">
        <div class="footer-content" style="justify-content:center; text-align:center;">
            <span>
                &copy; <span th:text="${#temporals.createNow().getYear()}">2026</span>
                Funky Hostel Hub ‚Äî belong to Shashi's Sons
                <span class="blink" aria-hidden="true">üòé</span>
                <span aria-label="smile">:)</span>
            </span>
        </div>
    </div>
</div>

<!-- Mobile-only floating footer nav -->
<nav class="footer-actions-fab" role="navigation" aria-label="Quick navigation" id="mobileFooterNav">
    <a class="btn" th:href="@{/api/v1}" aria-label="Home">Home</a>
    <a class="btn" th:href="@{/api/v1/hostels}" aria-label="Hostels">Hostels</a>
    <a class="btn" th:href="@{/api/v1/rooms}" aria-label="Rooms">Rooms</a>
    <a class="btn" th:href="@{/api/v1/reviews}" aria-label="Reviews">Reviews</a>
    <!-- Guest portal links -->
    <a class="btn" th:if="${guestSession} == null or ${guestSession.email} == null" th:href="@{/api/v1/guest/login}"
       aria-label="Guest Login">Guest</a>
    <span th:if="${guestSession} != null and ${guestSession.email} != null">
        <a class="btn" th:href="@{/api/v1/guest/my-rooms}" aria-label="My Rooms">Rooms</a>
        <a class="btn" th:href="@{/api/v1/guest/my-reviews}" aria-label="My Reviews">Reviews</a>
        <a class="btn" th:href="@{/api/v1/guest/logout}" aria-label="Logout">Logout</a>
    </span>
</nav>

<!-- Show toggle only if theme script is present -->
<button class="btn theme-toggle-fab" type="button" onclick="window.__toggleTheme()" aria-label="Toggle theme"
        th:if="${includeThemeScript} ?: true">üåì Toggle
</button>

<button class="chatbot-fab" type="button" id="chatbotToggle" aria-label="Open chat">
    <!-- SVG chat icon -->
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
         stroke-linecap="round" stroke-linejoin="round" style="vertical-align:middle;">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
</button>
<div class="chatbot-modal" id="chatbotModal" style="display:none;" role="dialog" aria-modal="true"
     aria-labelledby="chatbotModalTitle">
    <div class="chatbot-header">
        <span id="chatbotModalTitle">ChatBot</span>
        <button class="chatbot-close" type="button" aria-label="Close chat" id="chatbotClose">&times;</button>
    </div>
    <div class="chatbot-body" id="chatbotBody" tabindex="0">
        <div class="chatbot-message chatbot-message-bot">Hi! How can I help you?</div>
    </div>
    <form class="chatbot-form" id="chatbotForm" autocomplete="off">
        <label for="chatbotInput"></label><input type="text" id="chatbotInput" placeholder="Type your message..."
                                                 autocomplete="off"/>
        <button type="submit" aria-label="Send">Send</button>
    </form>
</div>
<!-- Chatbot behavior (conditional) -->
<script th:if="${includeChatbotScript} ?: true" defer th:src="@{/js/chatbot.js}"></script>

<div class="toast-container">
    <div th:if="${success}" class="toast success">
        <span class="toast-content">
            <span class="toast-icon" aria-hidden="true">‚úîÔ∏è</span>
            <span th:text="${success}">Success</span>
            <button class="toast-close" type="button" aria-label="Dismiss">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                     stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </span>
    </div>
    <div th:if="${error}" class="toast error">
        <span class="toast-content">
            <span class="toast-icon" aria-hidden="true">‚ö†Ô∏è</span>
            <span th:text="${error}">Error</span>
            <button class="toast-close" type="button" aria-label="Dismiss">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                     stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </span>
    </div>
    <div th:if="${info}" class="toast info">
        <span class="toast-content">
            <span class="toast-icon" aria-hidden="true">‚ÑπÔ∏è</span>
            <span th:text="${info}">Info</span>
            <button class="toast-close" type="button" aria-label="Dismiss">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                     stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </span>
    </div>
</div>
<!-- Toasts behavior (conditional) -->
<script th:if="${includeToastScript} ?: true" defer th:src="@{/js/toasts.js}"></script>

<div id="confirmModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="confirmModalTitle"
     style="display:none;">
    <div class="modal">
        <div class="modal-header">
            <span class="modal-title"><span class="modal-title-icon" aria-hidden="true">
                <!-- warning icon -->
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                     stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                    <line x1="12" y1="9" x2="12" y2="13"></line>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
            </span>
            <span id="confirmModalTitle">Confirm Delete</span></span>
            <button type="button" class="modal-close" id="confirmClose" aria-label="Close">
                <!-- close icon -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                     stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <p id="confirmMessage">Are you sure you want to delete this item?</p>
            <div class="actions" style="margin-top:.75rem; justify-content:flex-end;">
                <button type="button" class="btn" id="confirmYes">Confirm</button>
                <button type="button" class="btn" id="confirmNo" style="background:#6c757d">Cancel</button>
            </div>
        </div>
    </div>
</div>
<!-- External confirm modal script (conditional) -->
<script th:if="${includeConfirmScript} ?: true" defer th:src="@{/js/confirm-modal.js}"></script>
</body>
</html>
