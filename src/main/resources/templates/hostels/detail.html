<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(~{::content})}">
<section th:fragment="content">
    <div class="card">
        <h2 th:text="${hostel != null ? hostel.name : 'Not found'}">Hostel</h2>
        <div th:if="${hostel == null}"><p>Hostel not found.</p></div>
        <div th:if="${hostel != null}">
            <div class="form-row">
                <p style="flex:1"><strong>Address:</strong> <span th:text="${hostel.address}"></span></p>
                <p style="flex:1"><strong>Capacity:</strong> <span th:text="${hostel.capacity}"></span></p>
            </div>
            <div class="form-row">
                <p style="flex:1"><strong>Price per night:</strong>
                    <span th:text="${'â‚¬ ' + #numbers.formatDecimal(hostel.pricePerNight,1,2)}"></span>
                </p>
                <p style="flex:1"><strong>Status:</strong>
                    <span class="status-icon" role="img"
                          th:attr="aria-label=${hostel.available} ? 'Available' : 'Unavailable', data-tooltip=${hostel.available} ? 'Available' : 'Unavailable'"
                          th:classappend="${hostel.available} ? 'ok' : 'bad'">
                        <svg viewBox="0 0 24 24" class="icon" xmlns="http://www.w3.org/2000/svg" th:if="${hostel.available}">
                            <path d="M9 16.17l-3.88-3.88-1.41 1.41L9 19 20.3 7.71l-1.41-1.41z"/>
                        </svg>
                        <svg viewBox="0 0 24 24" class="icon" xmlns="http://www.w3.org/2000/svg" th:if="${!hostel.available}">
                            <path d="M18.3 5.71L12 12.01 5.7 5.71 4.29 7.12l6.3 6.29-6.3 6.29 1.41 1.41 6.3-6.29 6.29 6.29 1.41-1.41-6.29-6.29 6.29-6.29z"/>
                        </svg>
                    </span>
                </p>
            </div>
            <form th:action="@{|/hostels/${hostel.id}/delete|}" method="post" class="actions" style="margin-top:1rem">
                <button class="btn" style="background:#c0392b">Delete</button>
                <a class="btn" th:href="@{/hostels}" style="background:#6c757d">Back</a>
            </form>
        </div>
    </div>

    <div class="card">
        <h3>Booked Rooms</h3>
        <div class="actions" style="margin-bottom:.5rem">
            <a class="btn" th:href="@{/allocations/create}">Allocate a Room</a>
            <span class="muted" th:if="${allocations != null}" th:text="${'Total bookings: ' + allocations.size()}">Total bookings: 0</span>
        </div>
        <div class="table-wrap" th:if="${allocations != null && !#lists.isEmpty(allocations)}">
            <table class="table">
                <thead>
                <tr>
                    <th>Room</th>
                    <th>Guest</th>
                    <th>Check In</th>
                    <th>Check Out</th>
                    <th>Beds</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="a : ${allocations}">
                    <td th:text="${a.hostelRoomNumber}">Room</td>
                    <td th:text="${a.fullName}">Guest</td>
                    <td th:text="${#temporals.format(a.checkIn, 'yyyy-MM-dd HH:mm')}">Check In</td>
                    <td th:text="${#temporals.format(a.checkOut, 'yyyy-MM-dd HH:mm')}">Check Out</td>
                    <td th:text="${a.numberOfBed}">Beds</td>
                </tr>
                </tbody>
            </table>
        </div>
        <div th:if="${allocations == null || #lists.isEmpty(allocations)}" class="muted">
            No bookings yet for this hostel.
        </div>
    </div>
</section>
</html>
